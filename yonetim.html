<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YÃ¶netici Paneli | BAKÄ° S2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --purple: #6c5ce7; }
        body { 
            font-family: 'Poppins', sans-serif; 
            background-color: #110915; 
            color: #ffffff;
            min-height: 100vh;
            display: flex; 
        }
        .sidebar {
            background-color: #1a0e21; 
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.4);
            flex-shrink: 0;
            width: 250px;
        }
        .main-content {
            background-color: #110915;
            flex-grow: 1;
        }
        .admin-card {
            background-color: #1a0e21;
            border: 1px solid rgba(108, 92, 231, 0.3);
            border-radius: 0.75rem; 
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5); 
        }
        .nav-item {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            text-decoration: none;
            color: #e5e7eb;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        .nav-item.active {
            background-color: var(--purple);
            color: white;
            border-radius: 0.5rem;
            box-shadow: 0 2px 8px rgba(108, 92, 231, 0.5);
        }
        .nav-item:hover:not(.active) {
            background-color: rgba(108, 92, 231, 0.1);
            border-radius: 0.5rem;
        }
        #loadingOverlay {
            background-color: #110915; 
            z-index: 1000; 
            display: flex; 
        }
        /* Tablo Stili */
        .admin-table th {
            text-align: left;
            padding: 0.75rem;
            border-bottom: 2px solid #2a1b3a;
        }
        .admin-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #2a1b3a;
        }
    </style>
</head>
<body class="flex">

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const loadingOverlay = document.getElementById('loadingOverlay');
            if (loadingOverlay) {
                loadingOverlay.style.display = 'none';
            }
            const adminPanelWrapper = document.getElementById('adminPanelWrapper');
            if (adminPanelWrapper) {
                adminPanelWrapper.classList.remove('hidden');
            }
        });
    </script>
    
    <div id="loadingOverlay" class="fixed inset-0 flex flex-col items-center justify-center transition-opacity duration-500">
        <div class="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-purple-500 mb-4"></div>
        <p id="loadingMessage" class="text-lg text-white text-center">YÃ¶netici Paneli yÃ¼kleniyor...</p>
    </div>

    <div id="adminPanelWrapper" class="hidden w-full flex">
        
        <div class="sidebar h-screen p-4 flex flex-col">
            <div class="text-3xl font-extrabold text-white mb-8 text-center">
                <i class="fas fa-screwdriver-wrench text-purple-500 mr-1"></i> ADMIN
            </div>

            <nav class="flex-grow space-y-2">
                <a href="#" class="nav-item active" data-content="dashboard">
                    <i class="fas fa-chart-line w-6 mr-3"></i> YÃ¶netim Panosu
                </a>
                <a href="#" class="nav-item" data-content="analytics">
                    <i class="fas fa-chart-bar w-6 mr-3"></i> Analizler
                </a>
                <a href="#" class="nav-item" data-content="users">
                    <i class="fas fa-users w-6 mr-3"></i> KullanÄ±cÄ± YÃ¶netimi
                </a>
                <a href="#" class="nav-item" data-content="links">
                    <i class="fas fa-link w-6 mr-3"></i> Link YÃ¶netimi
                </a>
                <a href="#" class="nav-item" data-content="settings">
                    <i class="fas fa-cogs w-6 mr-3"></i> Sistem AyarlarÄ±
                </a>
            </nav>

            <div class="mt-auto pt-4 border-t border-gray-700">
                <button id="adminLogoutButton" style="display: none;" class="w-full flex items-center justify-center p-3 text-red-400 bg-gray-700 rounded-lg font-semibold hover:bg-red-800 hover:text-white transition duration-200">
                    <i class="fas fa-sign-out-alt mr-3"></i> Ã‡Ä±kÄ±ÅŸ Yap
                </button>
            </div>
        </div>

        <div class="main-content p-8 overflow-y-auto">
            <header class="mb-8 pb-4 border-b border-gray-700">
                <h1 id="pageTitle" class="text-4xl font-extrabold text-white">YÃ¶netim Panosu</h1>
                <p class="text-gray-400">Sistem verilerine hÄ±zlÄ± genel bakÄ±ÅŸ.</p>
            </header>

            <div id="dashboardContent" class="content-tab">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="admin-card p-6">
                        <i class="fas fa-users text-purple-400 text-3xl mb-3"></i>
                        <h4 class="text-2xl font-bold text-white" id="totalUsers">YÃ¼kleniyor...</h4>
                        <p class="text-gray-400">Toplam KullanÄ±cÄ± SayÄ±sÄ±</p>
                    </div>
                    <div class="admin-card p-6">
                        <i class="fas fa-link text-yellow-400 text-3xl mb-3"></i>
                        <h4 class="text-2xl font-bold text-white" id="totalLinks">YÃ¼kleniyor...</h4>
                        <p class="text-gray-400">OluÅŸturulan Toplam Link</p>
                    </div>
                    <div class="admin-card p-6">
                        <i class="fas fa-check-circle text-green-400 text-3xl mb-3"></i>
                        <h4 class="text-2xl font-bold text-white" id="premiumUsers">YÃ¼kleniyor...</h4>
                        <p class="text-gray-400">Aktif Premium Abonelik</p>
                    </div>
                </div>

                <div class="admin-card p-6 mt-8">
                    <h3 class="text-xl font-bold text-white mb-4">Sistem Durumu (AnlÄ±k)</h3>
                    <p class="text-gray-400">Link yÃ¶nlendirme performansÄ± son 24 saat iÃ§inde stabil.</p>
                </div>
            </div>

            <div id="analyticsContent" class="content-tab hidden">
                <h3 class="text-2xl font-bold text-white mb-4">Analizler ve Ä°statistikler <i class="fas fa-chart-bar ml-2 text-blue-400"></i></h3>
                <p class="text-gray-300 mb-6">Son 7 gÃ¼nlÃ¼k kullanÄ±cÄ± kaydÄ± ve link oluÅŸturma trendleri.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="admin-card p-6">
                        <h4 class="text-xl font-bold text-white mb-4">Son 7 GÃ¼nlÃ¼k KullanÄ±cÄ± KaydÄ±</h4>
                        <canvas id="userChart"></canvas>
                    </div>
                    <div class="admin-card p-6">
                        <h4 class="text-xl font-bold text-white mb-4">Son 7 GÃ¼nlÃ¼k Link OluÅŸturma</h4>
                        <canvas id="linkChart"></canvas>
                    </div>
                </div>

                <div class="admin-card p-6 mt-6">
                    <h4 class="text-xl font-bold text-white mb-4">En Ã‡ok TÄ±klanan Ä°lk 5 Link</h4>
                    <table class="admin-table w-full text-left">
                        <thead>
                            <tr>
                                <th class="text-purple-400">KÄ±sa URL</th>
                                <th class="text-purple-400">TÄ±klama</th>
                                <th class="text-purple-400">OluÅŸturan</th>
                            </tr>
                        </thead>
                        <tbody id="topLinksTableBody">
                            <tr><td>/deneme1</td><td>1250</td><td>user@mail.com</td></tr>
                            <tr><td>/kampanya</td><td>890</td><td>admin@mail.com</td></tr>
                            </tbody>
                    </table>
                </div>
            </div>
            
            <div id="usersContent" class="content-tab hidden">
                <h3 class="text-2xl font-bold text-white mb-4">KullanÄ±cÄ± YÃ¶netimi <i class="fas fa-user-shield ml-2 text-purple-400"></i></h3>
                <p class="text-gray-300 mb-6">KullanÄ±cÄ±larÄ± arayÄ±n, durumlarÄ±nÄ± gÃ¶rÃ¼ntÃ¼leyin ve moderasyon iÅŸlemlerini gerÃ§ekleÅŸtirin.</p>

                <div class="admin-card p-6 mb-6">
                    <h4 class="text-xl font-bold mb-3">ğŸ” KullanÄ±cÄ± Arama & Ä°ÅŸlemler</h4>
                    <div class="flex space-x-3 mb-4">
                        <input type="email" id="userSearchEmail" placeholder="KullanÄ±cÄ± E-posta Adresi..." class="flex-grow p-3 rounded-lg bg-gray-700 border border-gray-600 focus:ring-purple-500 focus:border-purple-500 text-white">
                        <button id="searchUserButton" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-5 rounded-lg transition duration-200">
                            Ara
                        </button>
                    </div>
                    <div id="userSearchResult" class="mt-4 text-gray-300">Arama sonuÃ§larÄ± burada gÃ¶sterilecek.</div>

                    <div id="moderationControls" class="mt-6 pt-4 border-t border-gray-700 space-y-3 hidden">
                        <h5 class="text-lg font-semibold text-white">SeÃ§ili KullanÄ±cÄ±ya Uygulanacak Eylemler</h5>
                         <select id="accountTypeSelect" class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 text-white">
                            <option value="BASIC">TEMEL Hesap</option>
                            <option value="PREMIUM">PREMIUM Hesap</option>
                            <option value="ADMIN">YÃ–NETÄ°CÄ° Hesap</option>
                        </select>
                        <button id="updateAccountTypeButton" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition duration-200">
                            <i class="fas fa-check mr-2"></i> Hesap Tipini GÃ¼ncelle
                        </button>
                        <button id="banUserButton" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg transition duration-200">
                            <i class="fas fa-ban mr-2"></i> HesabÄ± AskÄ±ya Al
                        </button>
                        <p class="text-sm text-yellow-400 mt-2">Bu eylemler iÃ§in Cloud Functions/Admin SDK gereklidir.</p>
                    </div>
                </div>
            </div>

            <div id="linksContent" class="content-tab hidden">
                <h3 class="text-2xl font-bold text-white mb-4">Link YÃ¶netimi <i class="fas fa-clipboard-list ml-2 text-yellow-400"></i></h3>
                <p class="text-gray-300 mb-6">Sistemdeki linkleri denetleyin, dondurun ve silin.</p>

                <div class="admin-card p-6 mb-6">
                    <h4 class="text-xl font-bold mb-3">ğŸ”— Toplu Link Ä°ÅŸlemleri</h4>
                    <p class="text-gray-400 mb-3">Bu, tÃ¼m linkleri veya filtrelediÄŸiniz linkleri etkiler.</p>
                    <button id="bulkFreezeButton" class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-5 rounded-lg transition duration-200">
                        <i class="fas fa-snowflake mr-2"></i> TÃ¼m Linkleri Dondur
                    </button>
                </div>

                <div class="admin-card p-6">
                    <h4 class="text-xl font-bold mb-3">ğŸš¨ Rapor Edilen ve Son Linkler</h4>
                    <p class="text-gray-400">AÅŸaÄŸÄ±daki tabloda en son 10 link yer almaktadÄ±r.</p>
                    <table class="admin-table w-full text-left mt-4">
                        <thead>
                            <tr>
                                <th class="text-yellow-400">KÄ±sa URL</th>
                                <th class="text-yellow-400">Hedef URL</th>
                                <th class="text-yellow-400">Durum</th>
                                <th class="text-yellow-400">Ä°ÅŸlem</th>
                            </tr>
                        </thead>
                        <tbody id="recentLinksTableBody">
                            <tr><td>/link1</td><td>https://google.com</td><td>Aktif</td><td><button class="text-red-400 hover:text-red-500 text-sm">Dondur</button></td></tr>
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="settingsContent" class="content-tab hidden">
                <h3 class="text-2xl font-bold text-white mb-4">Sistem AyarlarÄ± <i class="fas fa-server ml-2 text-green-400"></i></h3>
                <p class="text-gray-300 mb-6">UygulamanÄ±n genel ayarlarÄ±nÄ± ve bakÄ±m modunu yÃ¶netin.</p>

                <div class="admin-card p-6 mb-6">
                    <h4 class="text-xl font-bold mb-3">ğŸ‘· BakÄ±m Modu</h4>
                    <p class="text-gray-400 mb-3">TÃ¼m kullanÄ±cÄ± giriÅŸlerini ve link oluÅŸturmayÄ± geÃ§ici olarak durdurur.</p>
                    <button id="maintenanceModeToggle" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-5 rounded-lg transition duration-200">
                        <i class="fas fa-toggle-off mr-2"></i> BakÄ±m Modunu AÃ§
                    </button>
                    <p id="maintenanceStatus" class="mt-3 text-sm text-green-400 hidden"><i class="fas fa-check-circle mr-1"></i> Sistem bakÄ±m modundadÄ±r.</p>
                </div>

                <div class="admin-card p-6">
                    <h4 class="text-xl font-bold mb-3">ğŸ›¡ï¸ GÃ¼venlik AyarlarÄ±</h4>
                    <p class="text-gray-400 mb-3">Otomatik zararlÄ± link tespitini aÃ§/kapat.</p>
                    <label for="safeBrowsingToggle" class="flex items-center space-x-2 text-white">
                        <input type="checkbox" id="safeBrowsingToggle" class="form-checkbox text-purple-600 bg-gray-700 border-gray-600 rounded">
                        <span>Google GÃ¼venli Tarama API'si Entegrasyonu (VarsayÄ±msal)</span>
                    </label>
                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-5 rounded-lg mt-3 transition duration-200">
                        AyarlarÄ± Kaydet
                    </button>
                </div>
            </div>
        </div>

    </div>

    <script type="module" src="https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"></script>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut, fetchSignInMethodsForEmail } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        // Firestore'dan veri Ã§ekme fonksiyonlarÄ±
        import { getFirestore, collection, getDocs, query, where, limit } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // Firebase Config ve BaÅŸlatma
        const firebaseConfig = {
            apiKey: "AIzaSyBfc0F8o5aVmwTw-gyLRZVI2OMUljFi6Ao",
            authDomain: "baki-s2-yonetim.firebaseapp.com",
            projectId: "baki-s2-yonetim",
            storageBucket: "baki-s2-yonetim.firebasestorage.app",
            messagingSenderId: "692508919425",
            appId: "1:692508919425:web:fac963c81c11b7be70af80",
            measurementId: "G-Q52XG8GLB2"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // HTML Elementleri
        const loadingMessage = document.getElementById('loadingMessage');
        const adminLogoutButton = document.getElementById('adminLogoutButton');
        const navItems = document.querySelectorAll('.nav-item');
        const contentTabs = document.querySelectorAll('.content-tab');
        const pageTitle = document.getElementById('pageTitle');

        // YENÄ° ELEMANLAR
        const searchUserButton = document.getElementById('searchUserButton');
        const userSearchEmail = document.getElementById('userSearchEmail');
        const userSearchResult = document.getElementById('userSearchResult');
        const moderationControls = document.getElementById('moderationControls');
        const maintenanceModeToggle = document.getElementById('maintenanceModeToggle');
        const maintenanceStatus = document.getElementById('maintenanceStatus');
        const recentLinksTableBody = document.getElementById('recentLinksTableBody');

        // Chart deÄŸiÅŸkenleri
        let userChartInstance = null;
        let linkChartInstance = null;
        
        // --- KullanÄ±cÄ± ArayÃ¼zÃ¼ GÃ¼ncellemesi (Firebase durumuna gÃ¶re) ---
        function updateAdminUI(user) {
            if (user) {
                adminLogoutButton.style.display = 'flex'; 
                loadingMessage.textContent = `Oturum aÃ§Ä±k: ${user.email}. Veriler yÃ¼kleniyor...`;
            } else {
                adminLogoutButton.style.display = 'none';
                loadingMessage.textContent = 'GiriÅŸ yapÄ±lmadan eriÅŸildi. Sadece admin bilir.';
            }
        }

        // --- Veri Ã‡ekme Fonksiyonu (YÃ¶netim Panosu) ---
        async function loadDashboardData() {
            try {
                // Toplam KullanÄ±cÄ± SayÄ±sÄ±
                const usersSnapshot = await getDocs(collection(db, "users"));
                document.getElementById('totalUsers').textContent = usersSnapshot.size.toLocaleString('tr-TR');

                // Toplam Link SayÄ±sÄ±
                const linksSnapshot = await getDocs(collection(db, "links"));
                document.getElementById('totalLinks').textContent = linksSnapshot.size.toLocaleString('tr-TR');

                // Aktif Premium KullanÄ±cÄ± SayÄ±sÄ±
                const premiumQuery = query(collection(db, "users"), where("accountType", "==", "PREMIUM"));
                const premiumSnapshot = await getDocs(premiumQuery);
                document.getElementById('premiumUsers').textContent = premiumSnapshot.size.toLocaleString('tr-TR');

            } catch (e) {
                console.error("YÃ¶netim verileri yÃ¼klenirken hata (GÃ¼venlik KuralÄ± Ä°hlali OlasÄ±):", e);
                document.getElementById('totalUsers').textContent = 'HATA (Ä°zin Yok)';
                document.getElementById('totalLinks').textContent = 'HATA (Ä°zin Yok)';
                document.getElementById('premiumUsers').textContent = 'HATA (Ä°zin Yok)';
            }
        }
        
        // --- YENÄ° Ã–ZELLÄ°K: Analiz GrafiÄŸi Ã‡izme (VarsayÄ±msal Veri) ---
        function drawAnalyticsCharts() {
            // Var olan grafikleri temizle
            if (userChartInstance) userChartInstance.destroy();
            if (linkChartInstance) linkChartInstance.destroy();
            
            // VarsayÄ±msal Veriler (GerÃ§ek veriyi Ã§ekmek iÃ§in daha karmaÅŸÄ±k sorgular/Cloud Functions gerekir)
            const days = ['Pazartesi', 'SalÄ±', 'Ã‡arÅŸamba', 'PerÅŸembe', 'Cuma', 'Cumartesi', 'Pazar'];
            const userCounts = [15, 22, 18, 25, 30, 45, 35];
            const linkCounts = [50, 75, 60, 90, 110, 150, 120];

            // KullanÄ±cÄ± GrafiÄŸi
            const userCtx = document.getElementById('userChart').getContext('2d');
            userChartInstance = new Chart(userCtx, {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [{
                        label: 'Yeni KullanÄ±cÄ±lar',
                        data: userCounts,
                        borderColor: '#6c5ce7',
                        tension: 0.3,
                        backgroundColor: 'rgba(108, 92, 231, 0.2)',
                        fill: true,
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { beginAtZero: true, grid: { color: 'rgba(255, 255, 255, 0.1)' }, ticks: { color: 'white' } },
                        x: { grid: { display: false }, ticks: { color: 'white' } }
                    }
                }
            });

            // Link GrafiÄŸi
            const linkCtx = document.getElementById('linkChart').getContext('2d');
            linkChartInstance = new Chart(linkCtx, {
                type: 'bar',
                data: {
                    labels: days,
                    datasets: [{
                        label: 'OluÅŸturulan Linkler',
                        data: linkCounts,
                        backgroundColor: '#ffc107',
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { beginAtZero: true, grid: { color: 'rgba(255, 255, 255, 0.1)' }, ticks: { color: 'white' } },
                        x: { grid: { display: false }, ticks: { color: 'white' } }
                    }
                }
            });
        }


        // --- KullanÄ±cÄ± Arama Ä°ÅŸlevi ---
        searchUserButton.addEventListener('click', async () => {
            const email = userSearchEmail.value.trim();
            userSearchResult.innerHTML = 'KullanÄ±cÄ± aranÄ±yor...';
            moderationControls.classList.add('hidden'); // Yeni arama baÅŸladÄ±ÄŸÄ±nda gizle

            if (!email) {
                userSearchResult.innerHTML = '<span class="text-red-400">LÃ¼tfen bir e-posta adresi girin.</span>';
                return;
            }

            try {
                // Auth kontrolÃ¼
                const methods = await fetchSignInMethodsForEmail(auth, email);

                if (methods && methods.length > 0) {
                    // Firestore'dan kullanÄ±cÄ± verisini Ã§ek
                    const userQuery = query(collection(db, "users"), where("email", "==", email), limit(1));
                    const userSnap = await getDocs(userQuery);

                    if (!userSnap.empty) {
                        const userData = userSnap.docs[0].data();
                        
                        userSearchResult.innerHTML = `
                            <div class="mt-4 p-4 border border-green-500 rounded-lg bg-gray-800">
                                <h5 class="font-bold text-green-400">KullanÄ±cÄ± Bulundu: ${email}</h5>
                                <p>Hesap Tipi: <span id="currentAccountType" class="font-semibold">${userData.accountType || 'TEMEL'}</span></p>
                                <p>UID: <span id="targetUserUID">${userSnap.docs[0].id}</span></p>
                            </div>
                        `;
                        // Kontrolleri gÃ¶ster ve mevcut tipi seÃ§
                        moderationControls.classList.remove('hidden');
                        document.getElementById('accountTypeSelect').value = userData.accountType || 'BASIC';

                    } else {
                        userSearchResult.innerHTML = `<span class="text-yellow-400">Auth'da var, ancak Firestore 'users' kaydÄ± bulunamadÄ±.</span>`;
                    }
                } else {
                    userSearchResult.innerHTML = `<span class="text-red-400">Bu e-posta adresine kayÄ±tlÄ± bir kullanÄ±cÄ± bulunamadÄ±.</span>`;
                }

            } catch (error) {
                console.error("KullanÄ±cÄ± arama hatasÄ±:", error);
                userSearchResult.innerHTML = `<span class="text-red-400">Hata oluÅŸtu: ${error.message}. (GÃ¼venlik KuralÄ± Ä°hlali OlasÄ±)</span>`;
            }
        });
        
        // --- Sayfa GeÃ§iÅŸleri (Tab Switching) ---
        const switchTab = (targetContentId) => {
            contentTabs.forEach(tab => tab.classList.add('hidden'));
            document.getElementById(`${targetContentId}Content`).classList.remove('hidden');
            
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-content') === targetContentId) {
                    item.classList.add('active');
                }
            });
            
            const titleMap = {
                'dashboard': 'YÃ¶netim Panosu',
                'analytics': 'Sistem Analizleri',
                'users': 'KullanÄ±cÄ± YÃ¶netimi',
                'links': 'Link YÃ¶netimi',
                'settings': 'Sistem AyarlarÄ±'
            };
            pageTitle.textContent = titleMap[targetContentId] || 'YÃ¶netim Paneli';

            // Analiz sekmesine geÃ§ildiÄŸinde grafikleri Ã§iz
            if (targetContentId === 'analytics') {
                drawAnalyticsCharts();
            }
        };

        // --- Olay Dinleyicileri ---
        adminLogoutButton.addEventListener('click', async () => {
            try {
                await signOut(auth);
                window.location.reload(); 
            } catch (error) {
                console.error("Ã‡Ä±kÄ±ÅŸ hatasÄ±:", error);
                alert("Ã‡Ä±kÄ±ÅŸ yapÄ±lÄ±rken bir hata oluÅŸtu.");
            }
        });

        navItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                switchTab(item.getAttribute('data-content'));
            });
        });

        // BakÄ±m Modu Ä°ÅŸlevi (Sadece ArayÃ¼z Ã–rneÄŸi)
        maintenanceModeToggle.addEventListener('click', () => {
            const isActive = maintenanceModeToggle.classList.contains('bg-red-600');
            if (isActive) {
                maintenanceModeToggle.classList.replace('bg-red-600', 'bg-gray-500');
                maintenanceModeToggle.classList.replace('hover:bg-red-700', 'hover:bg-gray-600');
                maintenanceModeToggle.innerHTML = '<i class="fas fa-toggle-off mr-2"></i> BakÄ±m Modunu AÃ§';
                maintenanceStatus.classList.add('hidden');
            } else {
                maintenanceModeToggle.classList.replace('bg-gray-500', 'bg-red-600');
                maintenanceModeToggle.classList.replace('hover:bg-gray-600', 'hover:bg-red-700');
                maintenanceModeToggle.innerHTML = '<i class="fas fa-toggle-on mr-2"></i> BakÄ±m Modunu Kapat';
                maintenanceStatus.classList.remove('hidden');
                maintenanceStatus.textContent = 'UYARI: Sistem bakÄ±m modunda.';
                maintenanceStatus.classList.add('text-red-400');
            }
        });

        // --- BaÅŸlatma ---
        document.addEventListener('DOMContentLoaded', () => {
            switchTab('dashboard'); 

            // Firebase durumunu dinle
            onAuthStateChanged(auth, (user) => {
                updateAdminUI(user);
            });
           
            loadDashboardData(); 
        });

    </script>
</body>
</html>
