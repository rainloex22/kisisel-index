<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GiriÅŸ Yap | BAKÄ° S2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --purple: #6c5ce7; /* Mor vurgu rengi */
            --dark-bg: #0d0617; /* Ana BG */
            --card-bg: #1a0e21; /* Kart BG */
        }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--dark-bg);
            color: #ffffff;
            min-height: 100vh;
            display: flex; 
            flex-direction: column;
            overflow-x: hidden;
            position: relative;
        }
        .form-card {
            background-color: var(--card-bg);
            border: 1px solid rgba(108, 92, 231, 0.4); /* Daha belirgin Ã§erÃ§eve */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        .input-field {
            background-color: #3b2f4f;
            border: 1px solid transparent;
            color: white;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        .input-field:focus {
            border-color: var(--purple);
            box-shadow: 0 0 0 2px rgba(108, 92, 231, 0.5);
            outline: none;
        }
        .main-cta-button {
            background-color: var(--purple);
            box-shadow: 0 4px 15px rgba(108, 92, 231, 0.4);
            transition: transform 0.3s ease, background-color 0.3s ease;
        }
        .main-cta-button:hover {
            background-color: #5c4cd9;
            transform: translateY(-1px);
        }
        .alert {
            transition: opacity 0.3s ease;
        }
        /* NAVBAR STÄ°LLERÄ° */
        .header-bg {
            background-color: rgba(13, 6, 23, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        .profile-avatar-nav {
            width: 40px; height: 40px; line-height: 40px; font-size: 16px; font-weight: 600;
            background-color: var(--purple); color: white; border-radius: 50%; text-align: center;
            flex-shrink: 0; cursor: pointer; border: 2px solid var(--purple); overflow: hidden;
        }
        .card-dropdown { 
            background: rgba(26, 14, 33, 0.9); 
            backdrop-filter: blur(10px); 
            border-radius: 0.75rem; 
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.8); 
            border: 1px solid rgba(108, 92, 231, 0.3); z-index: 30;
        }
        /* ðŸ’¡ YENÄ°: Aktif Navbar Vurgu Stili */
        .nav-active {
            color: #a78bfa !important; 
            border-bottom: 2px solid var(--purple); 
            padding-bottom: 4px; 
        }
    </style>
</head>
<body class="flex flex-col">

    <header class="header-bg sticky top-0 z-20">
    <nav class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
        <a href="panel.html" class="text-3xl font-extrabold text-white flex items-center tracking-wider">
            <i class="fas fa-meteor text-purple-500 mr-2"></i> BAKÄ° <span class="text-gray-400 font-light">S2</span>
        </a>

        <div class="hidden md:flex space-x-8">
            <a href="panel.html" class="nav-link text-white hover:text-purple-400 transition duration-200 font-medium">Ana Panel</a>
            <a href="fiyatlandirma.html" class="nav-link text-white hover:text-purple-400 transition duration-200 font-medium">FiyatlandÄ±rma</a>
            <a href="kullanicipaneli.html" class="nav-link text-white hover:text-purple-400 transition duration-200 font-medium">KullanÄ±cÄ± Paneli</a>
            <a href="yardim.html" class="nav-link text-white hover:text-purple-400 transition duration-200 font-medium">YardÄ±m</a>
        </div>

        <div class="flex space-x-3 items-center">
            
            <div id="loggedOutNav" class="flex space-x-3 items-center">
                <a href="girisyap.html" class="nav-link px-5 py-2 rounded-lg font-semibold text-white border border-purple-500 hover:bg-purple-600/30 transition duration-200">GiriÅŸ Yap</a>
                <a href="kaydol.html" class="main-cta-button px-5 py-2 rounded-lg font-semibold text-white">Kaydol</a> 
            </div>

            <div id="loggedInNav" class="relative hidden"> 
                <button id="profileMenuButton" class="flex items-center space-x-3 p-2 rounded-full hover:bg-gray-700 transition duration-200 focus:outline-none">
                    <span id="nav_profile_initials" class="profile-avatar-nav flex-shrink-0">...</span> 
                    <div class="hidden sm:flex flex-col items-end">
                        <span id="nav_display_name" class="text-sm font-semibold text-white">YÃ¼kleniyor...</span>
                        <span id="nav_user_role" class="text-xs font-medium rounded-full px-2 py-0.5 mt-0.5" style="background-color: rgba(108, 92, 231, 0.3);">YÃ¼kleniyor...</span>
                    </div>
                    <i class="fas fa-chevron-down text-gray-400 text-xs hidden sm:block"></i>
                </button>
                
                <div id="profileDropdown" class="card-dropdown absolute right-0 mt-3 w-48 p-2 hidden">
                    <a href="kullanicipaneli.html" class="flex items-center p-2 text-sm text-gray-300 hover:bg-gray-700 rounded-lg transition duration-200">
                        <i class="fas fa-chart-line w-5 mr-2 text-purple-400"></i> Kontrol Paneli
                    </a>
                    <button id="logoutButtonNav" class="w-full text-left flex items-center p-2 text-sm text-white bg-red-600 hover:bg-red-700 rounded-lg transition duration-200 mt-2">
                        <i class="fas fa-sign-out-alt w-5 mr-2"></i> Ã‡Ä±kÄ±ÅŸ Yap
                    </button>
                </div>
            </div>
        </div>
    </nav>
</header>
    <main class="flex-grow flex justify-center items-center py-12">
        <div class="w-full max-w-md px-4">
            
            <div class="text-center mb-10">
                <a href="panel.html" class="text-4xl font-extrabold text-white flex items-center justify-center">
                    <i class="fas fa-terminal mr-3 text-purple-500"></i> BAKÄ° S2
                </a>
                <h2 class="text-2xl font-semibold mt-4 text-gray-300">HesabÄ±nÄ±za GiriÅŸ YapÄ±n</h2>
            </div>

            <div class="form-card p-8 rounded-xl">

                <form id="loginForm" class="space-y-6">
                    
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-300 mb-1">E-posta Adresi</label>
                        <input type="email" id="email" class="input-field w-full p-3 rounded-lg" placeholder="e-posta@adresiniz.com" required>
                    </div>

                    <div>
                        <label for="password" class="block text-sm font-medium text-gray-300 mb-1">Åžifre</label>
                        <input type="password" id="password" class="input-field w-full p-3 rounded-lg" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required>
                    </div>

                    <div class="flex justify-end">
                        <a href="sifremiunuttum.html" class="text-sm font-medium text-purple-400 hover:text-white transition duration-200">
                            Åžifremi Unuttum
                        </a>
                    </div>
                    
                    <div id="messageBox" class="alert p-3 rounded-lg text-sm font-medium hidden"></div>

                    <button type="submit" id="loginButton" class="main-cta-button w-full p-3 rounded-lg font-bold text-white text-lg">
                        GiriÅŸ Yap <i class="fas fa-sign-in-alt ml-2"></i>
                    </button>

                </form>

                <div class="mt-6 text-center text-sm">
                    <p class="text-gray-400">
                        HesabÄ±nÄ±z yok mu? 
                        <a href="kaydol.html" class="font-medium text-purple-400 hover:text-white transition duration-200">Hemen Kaydolun</a>
                    </p>
                </div>
                
            </div>
        </div>
    </main>

    <footer class="footer-style text-gray-300 p-8 mt-auto">
        <div class="container mx-auto px-4 grid grid-cols-2 md:grid-cols-4 gap-8">
            
            <div>
                <h4 class="text-xl font-bold text-white mb-4">BAKÄ° S2</h4>
                <p class="text-base">TÃ¼m dijital baÄŸlantÄ±larÄ±nÄ±zÄ± tek bir merkezde toplayÄ±n. HÄ±z, gÃ¼venlik ve analiz odaklÄ± Ã§Ã¶zÃ¼m.</p>
            </div>

            <div>
                <h4 class="text-xl font-bold text-white mb-4">Yasal</h4>
                <ul class="space-y-2">
                    <li><a href="gizlilik-politikasi.html" class="text-base hover:text-purple-400 transition duration-200">Gizlilik PolitikasÄ±</a></li>
                    <li><a href="kullanim-sartlari.html" class="text-base hover:text-purple-400 transition duration-200">KullanÄ±m ÅžartlarÄ±</a></li>
                    <li><a href="iade-iptal.html" class="text-base hover:text-purple-400 transition duration-200">Ä°ade/Ä°ptal</a></li>
                </ul>
            </div>
            
            <div>
                <h4 class="text-xl font-bold text-white mb-4">Site HaritasÄ±</h4>
                <ul class="space-y-2">
                    <li><a href="panel.html" class="text-base hover:text-purple-400 transition duration-200">Panel</a></li>
                    <li><a href="fiyatlandirma.html" class="text-base hover:text-purple-400 transition duration-200">FiyatlandÄ±rma</a></li>
                    <li><a href="yardim.html" class="text-base hover:text-purple-400 transition duration-200">YardÄ±m Merkezi</a></li>
                </ul>
            </div>

            <div>
                <h4 class="text-xl font-bold text-white mb-4">Ä°letiÅŸim</h4>
                <ul class="space-y-2">
                    <li><a href="discord" class="text-base hover:text-purple-400 transition duration-200"><i class="fab fa-discord mr-2"></i> Discord</a></li>
                    <li><a href="hizmet.html" class="text-base hover:text-purple-400 transition duration-200"><i class="fas fa-shield-alt mr-2"></i> Hizmet Durumu</a></li>
                </ul>
            </div>
        </div>
        
        <div class="text-center text-base mt-10 border-t border-gray-700 pt-6">
            Â© 2025 BAKÄ° S2. TÃ¼m haklarÄ± saklÄ±dÄ±r.
        </div>
    </footer>
    <script type="module" src="https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"></script>
    <script type="module" src="./firebase-auth-service.js"></script>

    <script type="module">
        // 1. Gerekli Firebase ModÃ¼llerini Ä°Ã§e Aktarma (Ä°Ã‡ERÄ°ÄžÄ° SADELEÅžTÄ°RÄ°LDÄ°)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { 
            getAuth, 
            signInWithEmailAndPassword, 
            setPersistence, 
            browserSessionPersistence,
            onAuthStateChanged
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        // NOT: firebase-auth-service.js dosyanÄ±zdaki tÃ¼m kodlar buraya taÅŸÄ±ndÄ±.

        // --- KRÄ°TÄ°K: BURAYI KENDÄ° FIREBASE AYARLARINIZLA GÃœNCELLEYÄ°N ---
        const firebaseConfig = {
            apiKey: "AIzaSyBfc0F8o5aVmwTw-gyLRZVI2OMUljFi6Ao", // <<<< LÃ¼tfen BURAYI KENDÄ° ANAHTARINIZLA GÃœNCELLEYÄ°N
            authDomain: "baki-s2-yonetim.firebaseapp.com", // <<<< LÃ¼tfen BURAYI KENDÄ° DOMAIN'Ä°NÄ°ZLE GÃœNCELLEYÄ°N
            projectId: "baki-s2-yonetim"
            // DiÄŸer ayarlar: storageBucket, messagingSenderId, appId, measurementId
        };
        // --- KRÄ°TÄ°K BÄ°TÄ°Åž ---

        // --- DOM Elementleri ---
        const loginForm = document.getElementById('loginForm');
        const emailInput = document.getElementById('email');
        const passwordInput = document.getElementById('password');
        const messageBox = document.getElementById('messageBox');
        const loginButton = document.getElementById('loginButton');
        const loggedOutNav = document.getElementById('loggedOutNav'); 
        const loggedInNav = document.getElementById('loggedInNav');

        let auth = null;
        let db = null;

        // --- YardÄ±mcÄ± Fonksiyonlar ---

        /** Mesaj kutusunu gÃ¶rÃ¼nÃ¼r yapar ve stilini ayarlar. */
        function displayMessage(message, type) {
            messageBox.innerHTML = message;
            messageBox.classList.remove('hidden', 'bg-red-900/30', 'text-red-300', 'bg-green-900/30', 'text-green-300');
            
            if (type === 'error') {
                messageBox.classList.add('bg-red-900/30', 'text-red-300');
            } else if (type === 'success') {
                messageBox.classList.add('bg-green-900/30', 'text-green-300');
            }
        }

        /** Sayfa yÃ¼klendiÄŸinde aktif linki belirler ve vurgular. */
        function setActiveNavLink() {
            // URL'den dosya adÄ±nÄ± alÄ±yoruz (Ã¶rneÄŸin: "girisyap.html")
            const currentPath = window.location.pathname.split('/').pop(); 
            const navLinks = document.querySelectorAll('.nav-link');
            
            navLinks.forEach(link => {
                const linkPath = link.getAttribute('href').split('/').pop();

                link.classList.remove('nav-active');
                
                // Linkin yolu, mevcut sayfanÄ±n yoluyla eÅŸleÅŸiyor mu?
                if (linkPath === currentPath) {
                    link.classList.add('nav-active');
                } 
                
                // Ana sayfa iÃ§in Ã¶zel kontrol
                if (currentPath === '' && linkPath === 'panel.html') {
                    link.classList.add('nav-active');
                }
            });
        }
        
        // --- Firebase BaÅŸlatma ve Oturum Ä°ÅŸlemleri ---
        const setupFirebase = async () => {
            if (!firebaseConfig.apiKey || firebaseConfig.apiKey.includes("YOUR_FIREBASE_API_KEY")) {
                console.error("KRÄ°TÄ°K HATA: Firebase API Key'i eksik.");
                displayMessage("Kritik Hata: Firebase yapÄ±landÄ±rmasÄ± eksik. LÃ¼tfen ayarlarÄ±nÄ±zÄ± gÃ¼ncelleyin.", 'error');
                return;
            }
            
            try {
                const app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);
                
                // Oturumun tarayÄ±cÄ± sekmesi kapanana kadar sÃ¼rmesi iÃ§in persistence ayarÄ±
                await setPersistence(auth, browserSessionPersistence); 
                
                // Oturum deÄŸiÅŸimini dinle (Navbar iÃ§in)
                onAuthStateChanged(auth, (user) => {
                    // Bu sayfada sadece giriÅŸ/kayÄ±t butonlarÄ±nÄ± yÃ¶netiyoruz.
                    if (user && !user.isAnonymous) {
                         // GiriÅŸ yapmÄ±ÅŸ kullanÄ±cÄ±yÄ± hemen panele yÃ¶nlendir (EÄŸer hali hazÄ±rda giriÅŸ varsa)
                         window.location.href = "panel.html"; 
                    } else {
                        // GiriÅŸ yapmamÄ±ÅŸ durum
                        if(loggedOutNav) loggedOutNav.classList.remove('hidden');
                        if(loggedInNav) loggedInNav.classList.add('hidden');
                    }
                });

            } catch (e) {
                console.error("Firebase BaÅŸlatma HatasÄ±:", e);
                displayMessage("Kritik Hata: Sunucuya baÄŸlanÄ±lamadÄ±. Konsolu kontrol edin.", 'error');
                auth = null;
            }
        };


        // --- Ana GiriÅŸ Ä°ÅŸlemi ---
        loginForm?.addEventListener('submit', async (e) => {
            e.preventDefault();

            const email = emailInput.value.trim();
            const password = passwordInput.value;

            if (!email || !password) {
                displayMessage('<i class="fas fa-exclamation-triangle mr-2"></i> LÃ¼tfen tÃ¼m alanlarÄ± doldurun.', 'error');
                return;
            }
            
            if (!auth) {
                displayMessage('<i class="fas fa-server mr-2"></i> Sistem hatasÄ±: Kimlik doÄŸrulama servisi hazÄ±r deÄŸil.', 'error');
                return;
            }

            // Butonu devre dÄ±ÅŸÄ± bÄ±rak ve yÃ¼kleniyor durumunu gÃ¶ster
            loginButton.disabled = true;
            loginButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> GiriÅŸ YapÄ±lÄ±yor...';
            messageBox.classList.add('hidden'); 

            try {
                const userCredential = await signInWithEmailAndPassword(auth, email, password);
                
                displayMessage('<i class="fas fa-check-circle mr-2"></i> GiriÅŸ baÅŸarÄ±lÄ±! YÃ¶nlendiriliyorsunuz...', 'success');
                
                setTimeout(() => {
                    // YÃ¶nlendirme
                    window.location.href = "panel.html"; 
                }, 1000);

            } catch (error) {
                console.error("GiriÅŸ hatasÄ±:", error.code, error.message);
                
                let errorMessage = '<i class="fas fa-bomb mr-2"></i> Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.';

                switch (error.code) {
                    case 'auth/user-not-found':
                    case 'auth/wrong-password':
                        errorMessage = '<i class="fas fa-user-slash mr-2"></i> E-posta veya ÅŸifre hatalÄ±. LÃ¼tfen kontrol edin.';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = '<i class="fas fa-at mr-2"></i> GeÃ§ersiz e-posta formatÄ±.';
                        break;
                    case 'auth/user-disabled':
                        errorMessage = '<i class="fas fa-ban mr-2"></i> HesabÄ±nÄ±z askÄ±ya alÄ±nmÄ±ÅŸtÄ±r.';
                        break;
                    case 'auth/too-many-requests':
                        errorMessage = '<i class="fas fa-clock mr-2"></i> Ã‡ok fazla baÅŸarÄ±sÄ±z giriÅŸ denemesi. LÃ¼tfen daha sonra tekrar deneyin.';
                        break;
                    default:
                        errorMessage = `<i class="fas fa-bug mr-2"></i> Sunucuya baÄŸlanÄ±lamadÄ±.`;
                        break;
                }

                displayMessage(errorMessage, 'error');
                
                // Butonu tekrar etkinleÅŸtir
                loginButton.disabled = false;
                loginButton.innerHTML = 'GiriÅŸ Yap <i class="fas fa-sign-in-alt ml-2"></i>';
            }
        });


        // --- BaÅŸlatma ---
        document.addEventListener('DOMContentLoaded', () => {
            setupFirebase();
            setActiveNavLink();
        });
        
    </script>
</body>
</html>
